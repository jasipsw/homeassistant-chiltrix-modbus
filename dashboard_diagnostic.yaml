title: CX Diagnostic Dashboard
views:
  - title: Sensor Values
    cards:
      - type: markdown
        title: "📊 CX50 Modbus Registers (Ordered by Address)"
        content: |
          | Addr | Hex | Sensor Name | Entity ID | Value |
          |------|-----|-------------|-----------|-------|
          | 0 | 0x00 | Power Status | `binary_sensor.cx50_power_status` | {{ states('binary_sensor.cx50_power_status') }} |
          | 1 | 0x01 | Heating Mode | `binary_sensor.cx50_heating_mode` | {{ states('binary_sensor.cx50_heating_mode') }} |
          | 2 | 0x02 | Cooling Mode | `binary_sensor.cx50_cooling_mode` | {{ states('binary_sensor.cx50_cooling_mode') }} |
          | 4 | 0x04 | DHW Mode Active | `binary_sensor.cx50_dhw_mode_active` | {{ states('binary_sensor.cx50_dhw_mode_active') }} |
          | 5 | 0x05 | Defrost Active | `binary_sensor.cx50_defrost_active` | {{ states('binary_sensor.cx50_defrost_active') }} |
          | 6 | 0x06 | Pump Enabled | `binary_sensor.cx50_pump_enabled` | {{ states('binary_sensor.cx50_pump_enabled') }} |
          | 202 | 0xCA | Inlet Water Temp | `sensor.cx50_inlet_water_temp_c` | {{ states('sensor.cx50_inlet_water_temp_c') }} °C |
          | 203 | 0xCB | Outlet Water Temp | `sensor.cx50_outlet_water_temp_c` | {{ states('sensor.cx50_outlet_water_temp_c') }} °C |
          | 204 | 0xCC | Ambient Temp | `sensor.cx50_ambient_temp_c` | {{ states('sensor.cx50_ambient_temp_c') }} °C |
          | 205 | 0xCD | Coil Temp | `sensor.cx50_coil_temp_c` | {{ states('sensor.cx50_coil_temp_c') }} °C |
          | 206 | 0xCE | Discharge Temp | `sensor.cx50_discharge_temp_c` | {{ states('sensor.cx50_discharge_temp_c') }} °C |
          | 207 | 0xCF | Suction Temp | `sensor.cx50_suction_temp_c` | {{ states('sensor.cx50_suction_temp_c') }} °C |
          | 209 | 0xD1 | Setpoint Temp | `sensor.cx50_setpoint_temp_c` | {{ states('sensor.cx50_setpoint_temp_c') }} °C |
          | 213 | 0xD5 | DHW Setpoint | `sensor.cx50_dhw_setpoint_c` | {{ states('sensor.cx50_dhw_setpoint_c') }} °C |
          | 214 | 0xD6 | Antifreeze Temp | `sensor.cx50_antifreeze_temp_c` | {{ states('sensor.cx50_antifreeze_temp_c') }} °C |
          | 243 | 0xF3 | Operating Mode | `sensor.cx50_operating_mode` | {{ states('sensor.cx50_operating_mode') }} |
          | 244 | 0xF4 | Error Code | `sensor.cx50_error_code` | {{ states('sensor.cx50_error_code') }} |
          | 256 | 0x100 | Input AC Voltage | `sensor.cx50_input_ac_voltage` | {{ states('sensor.cx50_input_ac_voltage') }} V |
          | 256 | 0x100 | Input AC Current | `sensor.cx50_input_ac_current` | {{ states('sensor.cx50_input_ac_current') }} A |
          | 257 | 0x101 | Pump Flow | `sensor.cx50_pump_flow_lpm` | {{ states('sensor.cx50_pump_flow_lpm') }} L/min |
          | 258 | 0x102 | Compressor Frequency | `sensor.cx50_compressor_frequency` | {{ states('sensor.cx50_compressor_frequency') }} Hz |
          | 259 | 0x103 | Fan Motor 1 Speed | `sensor.cx50_c45_ec_fan_motor_1_speed` | {{ states('sensor.cx50_c45_ec_fan_motor_1_speed') }} |
          | 259 | 0x103 | Fan Motor 2 Speed | `sensor.cx50_c46_ec_fan_motor_2_speed` | {{ states('sensor.cx50_c46_ec_fan_motor_2_speed') }} |
          | 260 | 0x104 | Pump Speed | `sensor.cx50_pump_speed` | {{ states('sensor.cx50_pump_speed') }} % |
          | 261 | 0x105 | System Pressure | `sensor.cx50_system_pressure` | {{ states('sensor.cx50_system_pressure') }} bar |
          | 262 | 0x106 | Silent Mode | `binary_sensor.cx50_silent_mode` | {{ states('binary_sensor.cx50_silent_mode') }} |
          | 263 | 0x107 | DHW Priority | `binary_sensor.cx50_dhw_priority` | {{ states('binary_sensor.cx50_dhw_priority') }} |
          | 264 | 0x108 | Total Run Hours | `sensor.cx50_total_run_hours` | {{ states('sensor.cx50_total_run_hours') }} h |
          | 281 | 0x119 | Compressor Starts | `sensor.cx50_compressor_starts` | {{ states('sensor.cx50_compressor_starts') }} |
          | 285 | 0x11D | Defrost Count | `sensor.cx50_defrost_count` | {{ states('sensor.cx50_defrost_count') }} |

      - type: markdown
        title: "🔍 Temperature Sensors (Modbus)"
        content: |
          **Inlet:** {{ states('sensor.cx50_inlet_water_temp_c') }}°C
          **Outlet:** {{ states('sensor.cx50_outlet_water_temp_c') }}°C
          **Ambient:** {{ states('sensor.cx50_ambient_temp_c') }}°C

      - type: markdown
        title: "⚡ Electrical Sensors (Modbus)"
        content: |
          **Voltage:** {{ states('sensor.cx50_input_ac_voltage') }}V
          **Current:** {{ states('sensor.cx50_input_ac_current') }}A
          **Compressor Frequency:** {{ states('sensor.cx50_compressor_frequency') }}Hz

      - type: markdown
        title: "💧 Flow Sensors (Modbus)"
        content: |
          **Flow Rate:** {{ states('sensor.cx50_pump_flow_lpm') }} L/min
          **Operating Mode:** {{ states('sensor.cx50_operating_mode') }} (raw)

      - type: markdown
        title: "🌀 Fan Sensors (Modbus)"
        content: |
          **Fan 1 Speed:** {{ states('sensor.cx50_c45_ec_fan_motor_1_speed') }}
          **Fan 2 Speed:** {{ states('sensor.cx50_c46_ec_fan_motor_2_speed') }}

      - type: markdown
        title: "🔢 Calculated Template Sensors"
        content: |
          **Operating Mode Text:** {{ states('sensor.cx_operating_mode') }}
          **Temperature Delta:** {{ states('sensor.cx_water_temperature_delta') }}{{ state_attr('sensor.cx_water_temperature_delta', 'unit_of_measurement') }}
          **Electrical Power Input:** {{ states('sensor.cx_electrical_power_input') }}W ({{ states('sensor.cx_electrical_power_input_kw') }}kW)
          **Thermal Power Output:** {{ states('sensor.cx_thermal_power_output') }}W ({{ states('sensor.cx_thermal_power_output_kw') }}kW)
          **COP:** {{ states('sensor.cx_cop') }}
          **COP Heating:** {{ states('sensor.cx_cop_heating_mode') }}
          **COP Cooling:** {{ states('sensor.cx_cop_cooling_mode') }}
          **COP DHW:** {{ states('sensor.cx_cop_dhw_mode') }}
          **Efficiency Rating:** {{ states('sensor.cx_efficiency_rating') }}
          **Compressor Speed:** {{ states('sensor.cx_compressor_speed_2') }}%
          **Fan Speed:** {{ states('sensor.cx_fan_speed_2') }}%

      - type: markdown
        title: "⚙️ Helper Inputs"
        content: |
          **Fluid Density:** {{ states('input_number.cx_fluid_density') }} kg/m³
          **Fluid Specific Heat:** {{ states('input_number.cx_fluid_specific_heat') }} kJ/(kg·°C)

      - type: markdown
        title: "📊 Calculated Values (Manual Check)"
        content: |
          **Power Calc (V×I):** {{ (states('sensor.cx50_input_ac_voltage')|float * states('sensor.cx50_input_ac_current')|float)|round(0) }}W
          **Temp Delta Calc:** {{ (states('sensor.cx50_outlet_water_temp_c')|float - states('sensor.cx50_inlet_water_temp_c')|float)|round(2) }}°C
          **COP Calc:** {{ (states('sensor.cx_thermal_power_output')|float / states('sensor.cx_electrical_power_input')|float)|round(2) if states('sensor.cx_electrical_power_input')|float > 0 else 'N/A' }}
          **Fan Avg Calc:** {{ ((states('sensor.cx50_c45_ec_fan_motor_1_speed')|float + states('sensor.cx50_c46_ec_fan_motor_2_speed')|float) / 2 / 10)|round(1) }}%
